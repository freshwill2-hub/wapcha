#!/bin/bash

echo "=========================================="
echo "ğŸ“ ì¹´í”¼ì¸„2 Git ë™ê¸°í™” ìƒíƒœ í™•ì¸"
echo "=========================================="
echo ""

cd /root/copychu-scraper

# 1. í˜„ì¬ ë¸Œëœì¹˜ í™•ì¸
echo "ğŸ”– í˜„ì¬ ë¸Œëœì¹˜:"
git branch --show-current
echo ""

# 2. ì›ê²© ì €ì¥ì†Œ ìµœì‹  ì •ë³´ ê°€ì ¸ì˜¤ê¸°
echo "ğŸ”„ ì›ê²© ì €ì¥ì†Œ ì •ë³´ ì—…ë°ì´íŠ¸ ì¤‘..."
git fetch origin
echo ""

# 3. ë¡œì»¬ê³¼ ì›ê²© ë¸Œëœì¹˜ ë¹„êµ
echo "ğŸ“Š ë¡œì»¬ vs ì›ê²© ìƒíƒœ:"
git status
echo ""

# 4. ì¶”ì ë˜ì§€ ì•ŠëŠ” íŒŒì¼ ëª©ë¡
echo "=========================================="
echo "âš ï¸  Gitì— ì¶”ì ë˜ì§€ ì•ŠëŠ” íŒŒì¼ë“¤:"
echo "=========================================="
git ls-files --others --exclude-standard
echo ""

# 5. ë³€ê²½ëœ íŒŒì¼ ëª©ë¡
echo "=========================================="
echo "ğŸ“ ë³€ê²½ëœ íŒŒì¼ë“¤:"
echo "=========================================="
git diff --name-status
echo ""

# 6. ë¡œì»¬ì—ë§Œ ìˆëŠ” ì»¤ë°‹
echo "=========================================="
echo "â¬†ï¸  ë¡œì»¬ì—ë§Œ ìˆëŠ” ì»¤ë°‹ (push í•„ìš”):"
echo "=========================================="
git log origin/main..HEAD --oneline 2>/dev/null || echo "ì—†ìŒ"
echo ""

# 7. ì›ê²©ì—ë§Œ ìˆëŠ” ì»¤ë°‹
echo "=========================================="
echo "â¬‡ï¸  ì›ê²©ì—ë§Œ ìˆëŠ” ì»¤ë°‹ (pull í•„ìš”):"
echo "=========================================="
git log HEAD..origin/main --oneline 2>/dev/null || echo "ì—†ìŒ"
echo ""

# 8. ì‹¤ì œ íŒŒì¼ ì‹œìŠ¤í…œ vs Git ë¹„êµ
echo "=========================================="
echo "ğŸ“‚ ì„œë²„ì— ìˆëŠ” Phase íŒŒì¼ë“¤:"
echo "=========================================="
ls -lh /root/copychu-scraper/phase*.js 2>/dev/null || echo "phase*.js íŒŒì¼ ì—†ìŒ"
echo ""

# 9. Gitì´ ì¶”ì í•˜ëŠ” Phase íŒŒì¼ë“¤
echo "=========================================="
echo "ğŸ” Gitì´ ì¶”ì í•˜ëŠ” Phase íŒŒì¼ë“¤:"
echo "=========================================="
git ls-files 'phase*.js'
echo ""

# 10. ê¶Œì¥ ì‚¬í•­
echo "=========================================="
echo "ğŸ’¡ ê¶Œì¥ ì‚¬í•­:"
echo "=========================================="

# Untracked filesê°€ ìˆëŠ” ê²½ìš°
if [ -n "$(git ls-files --others --exclude-standard)" ]; then
    echo "1. ì¶”ì ë˜ì§€ ì•ŠëŠ” íŒŒì¼ë“¤ì„ Gitì— ì¶”ê°€:"
    echo "   git add <íŒŒì¼ëª…>"
    echo ""
fi

# Modified filesê°€ ìˆëŠ” ê²½ìš°
if [ -n "$(git diff --name-only)" ]; then
    echo "2. ë³€ê²½ëœ íŒŒì¼ë“¤ì„ ì»¤ë°‹:"
    echo "   git add -A"
    echo "   git commit -m 'ë³€ê²½ì‚¬í•­ ì»¤ë°‹'"
    echo ""
fi

# ë¡œì»¬ ì»¤ë°‹ì´ ìˆëŠ” ê²½ìš°
if [ -n "$(git log origin/main..HEAD --oneline 2>/dev/null)" ]; then
    echo "3. ë¡œì»¬ ì»¤ë°‹ì„ GitHubì— í‘¸ì‹œ:"
    echo "   git push origin main"
    echo ""
fi

# ì›ê²© ì»¤ë°‹ì´ ìˆëŠ” ê²½ìš°
if [ -n "$(git log HEAD..origin/main --oneline 2>/dev/null)" ]; then
    echo "4. ì›ê²© ë³€ê²½ì‚¬í•­ì„ ë¡œì»¬ë¡œ ê°€ì ¸ì˜¤ê¸°:"
    echo "   git pull origin main"
    echo ""
fi

echo "=========================================="